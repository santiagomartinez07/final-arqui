
Init_Loop
  MOV ACC, CTE
  TAM
  MOV DPTR, ACC
  MOV ACC, [DPTR]
  INV ACC
  MOV A, ACC

  MOV ACC, CTE
  0x01
  ADD ACC, A
  MOV A, ACC

  MOV ACC, CTE
  ITERATOR
  MOV DPTR, ACC
  MOV ACC, [DPTR]
  ADD ACC, A
  JN CTE
  CICLO_BOOTH
  JMP CTE
  END_LOOP

CICLO_BOOTH
  MOV ACC, CTE
  Q(LSB)
  MOV DPTR, ACC
  MOV ACC, [DPTR]
  MOV A, ACC

  MOV ACC, CTE
  G
  MOV DPTR, ACC
  MOV ACC, A
  MOV [DPTR], ACC

  MOV ACC, CTE
  Q-1
  MOV DPTR, ACC
  MOV ACC, [DPTR]
  INV ACC
  MOV A, ACC

  MOV ACC, CTE
  0x01
  ADD ACC, A
  MOV A, ACC

  MOV ACC, CTE
  G
  MOV DPTR, ACC
  MOV ACC, [DPTR]
  ADD ACC, A
  JZ CTE
  DESPLAZAMIENTO

  MOV ACC, CTE
  Q(LSB)
  MOV DPTR, ACC
  MOV ACC, [DPTR]
  JZ CTE
  SUMA
  JMP CTE
  RESTA

DESPLAZAMIENTO
  MOV ACC, CTE
  Q(LSB)
  MOV DPTR, ACC
  MOV ACC, [DPTR]
  MOV A, ACC

  MOV ACC, CTE
  Q-1
  MOV DPTR, ACC
  MOV [DPTR], A

  MOV ACC, CTE
  Q(MSB)
  MOV DPTR, ACC
  MOV ACC, [DPTR]
  MOV A, ACC

  MOV ACC, CTE
  Q
  MOV DPTR, ACC
  MOV ACC, [DPTR]
  SHR ACC, 1
  MOV [DPTR], ACC

  MOV ACC, CTE
  Q(MSB)
  MOV DPTR, ACC
  MOV [DPTR], A

  MOV ACC, CTE
  A(MSB)
  MOV DPTR, ACC
  MOV ACC, [DPTR]
  MOV A, ACC

  MOV ACC, CTE
  A
  MOV DPTR, ACC
  MOV ACC, [DPTR]
  SHR ACC, 1
  MOV [DPTR], ACC

  MOV ACC, CTE
  A(MSB)
  MOV DPTR, ACC
  MOV [DPTR], A

  JMP CTE
  Init_Loop

SUMA
  MOV ACC, CTE
  M
  MOV DPTR, ACC
  MOV ACC, [DPTR]
  MOV A, ACC

  MOV ACC, CTE
  A
  MOV DPTR, ACC
  MOV ACC, [DPTR]
  ADD ACC, A
  MOV A, ACC

  MOV ACC, CTE
  A
  MOV DPTR, ACC
  MOV ACC, A
  MOV [DPTR], ACC

  JMP CTE
  DESPLAZAMIENTO

RESTA
  MOV ACC, CTE
  M
  MOV DPTR, ACC
  MOV ACC, [DPTR]
  INV ACC

  MOV ACC, CTE
  0x01
  ADD ACC, A
  MOV A, ACC

  MOV ACC, CTE
  A
  MOV DPTR, ACC
  MOV ACC, [DPTR]
  ADD ACC, A
  MOV A, ACC

  MOV ACC, CTE
  A
  MOV DPTR, ACC
  MOV ACC, A
  MOV [DPTR], ACC

  JMP CTE
  DESPLAZAMIENTO
